---
title: "ENABLE_USER_SCRIPT_SANDBOXINGとは何なのか?"
emoji: "📃"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Xcode","Xcode15","Swift","SwiftLint"]
published: true
published_at: 2023-11-22 21:00
---
### 前提となる環境
- Xcode15.0.1 (15A507)
- SwiftLint v0.54.0
### はじめに
Xcode14から、`hogehoge.xcodeproj/project.pbxproj`の`Build Settings`の中に`ENABLE_USER_SCRIPT_SANDBOXING`という項目ができました。(Xcode上ではUser Script Sandboxing)

![](/images/f176caa8e4e63b/image1.png)


この項目のデフォルト値が、Xcode15になった際に`NO` から`YES` に変更された影響で、ビルド時にSwiftLintなどのスクリプトを実行する際に以下のようなエラーが発生した方も多いのではないかと思います。

`Sandbox: swiftlint(99054) deny(1) file-read-data`

[現時点(2023/11/22)でSwiftLintが推奨する対応](https://github.com/realm/SwiftLint/blob/d1e5810b274dd1f9572a9199144619d41733768f/README.md#xcode)は、`ENABLE_USER_SCRIPT_SANDBOXING = No`にすることですが、この値を変更することによって具体的に何が起きるのでしょうか?



### ENABLE_USER_SCRIPT_SANDBOXINGって何？

一つずつ単語の意味を追ってみると、
- ユーザースクリプト
    -  (Build Settingsの文脈においては)ビルド時の動作をカスタマイズするスクリプトのこと
- SandBoxing(サンドボックス化)
    - システムの他の部分から隔離された仮想領域内で、制限されたリソースへのアクセスのみ許可して動作させる状態のこと

となります。つまりどういうオプションかと言うと、



**ビルド時の動作をカスタマイズするスクリプトを実行する際に、許可されたリソースに対してのみアクセスできるようにするオプション**

と言えるでしょう。

ちなみに、どのリソースにアクセスするかはBuild PhasesのInput files, Output filesで指定することができます。

![](/images/f176caa8e4e63b/image2.png)



###  ENABLE_USER_SCRIPT_SANDBOXINGを有効にするメリットは?


ユーザースクリプトがシステム全体に影響を及ぼすのを防ぐことができるというメリットが考えられます。

例えば、もし悪さをするスクリプトが混ざっていたとしても、アクセス範囲を絞ることによって被害を抑えることができます。

### 今後のプロジェクト開発でどのように設定すればいいか?

現時点(2023/11/22)では、Swiftによる開発で必須のSwiftLintによって`ENABLE_USER_SCRIPT_SANDBOXING = YES`にすることができないため、しばらくは`NO`にせざるを得ないと思います。

今後のSwiftLintを含む他のライブラリの対応やXcodeの変更によって、設定方法も変わってくると思うので、引き続きそれらのリリースノートをウォッチしていきます。

- [SwiftLintのリリースノート](https://github.com/realm/SwiftLint/releases)
- [Xcodeのリリースノート](https://developer.apple.com/documentation/xcode-release-notes)
